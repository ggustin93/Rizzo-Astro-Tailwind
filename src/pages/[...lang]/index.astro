---
import { getEntry } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import CTA from '../../components/CTA.astro';
import { CheckCircle } from 'astro-feather-icons';
import { getArticles } from '../../utils/articles';
import ArticleCard from '../../components/ArticleCard.astro';
import { Picture, Image } from 'astro:assets';

// Import des images locales
import heroImage from '../../assets/images/hero_image_wbg.svg';
import profileImage from '../../assets/images/chrizzo-pp.avif';

const supportedLanguages = ['fr', 'en', 'it'] as const;
type SupportedLanguage = typeof supportedLanguages[number];

export interface Props {
  currentLang: SupportedLanguage;
}

export async function getStaticPaths() {
  return ['fr', 'en', 'it'].map(lang => ({ params: { lang } }));
}

const { currentLang } = Astro.props as Props;

const { lang } = Astro.params;
const homeEntry = await getEntry('home', 'home');
const content = homeEntry.data[lang] as any;

// Récupération des articles
const recentArticles = await getArticles(lang, 3);

---

<BaseLayout title={content.hero.title} lang={currentLang}>  
  <!-- Hero Section -->
  <section class="pb-10 bg-beige">
    <div class="container mx-auto px-4 flex flex-col md:flex-row items-center justify-between">
      <div class="md:w-1/2 text-left mb-8 md:mb-0">
        <h1 class="text-7xl font-light mb-4 text-black">{content.hero.title}</h1>
        <h2 class="text-4xl mb-6 text-accent font-light">{content.hero.subtitle}</h2>
        <p class="mb-8 text-lg text-dark-gray max-w-xl font-light leading-relaxed">{content.hero.description}</p>
        <button data-calendly class="bg-transparent text-black border border-black px-6 py-3 rounded-sm hover:bg-black hover:text-white transition duration-300 uppercase text-base font-light">{content.hero.cta}</button>
        <div class="mt-12">
          <a href="#expertise" class="text-black hover:text-accent text-sm uppercase font-light transition duration-300">scroll ↓</a>
        </div>
      </div>
      <div class="md:w-1/2 flex justify-end">
        <Picture src={heroImage} formats={['avif', 'webp']} alt="Christine Rizzo" class="w-full max-w-lg" decoding="async" loading="eager" />
      </div>
    </div>
  </section>

  <!-- Expertise Section -->
  <section id="expertise" class="py-20 bg-light-gray">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-light mb-8 text-center text-black">{content.expertise.title}</h2>
      <p class="text-center mb-12 max-w-3xl mx-auto text-dark-gray font-light leading-relaxed">{content.expertise.description}</p>
      <div class="flex flex-col md:flex-row justify-center space-y-8 md:space-y-0 md:space-x-12">
        <div class="bg-beige p-8 rounded-sm flex-1 max-w-md">
          <div class="h-48 mb-4 relative">
            <img src="https://images.pexels.com/photos/4195397/pexels-photo-4195397.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Travailleurs" class="absolute inset-0 w-full h-full object-cover object-top" width="1260" height="750">
          </div>
          <h3 class="text-2xl font-light mb-4 text-black">{content.travailleurs.title}</h3>
          <p class="mb-4 text-dark-gray font-light leading-relaxed">{content.travailleurs.description}</p>
          <a href={`/${lang}/travailleurs`} class="inline-block bg-accent text-black px-4 py-2 rounded-sm hover:bg-black hover:text-accent transition duration-300 text-sm uppercase font-light">{content.travailleurs.cta}</a>
        </div>
        <div class="bg-beige p-8 rounded-sm flex-1 max-w-md">
          <div class="h-48 mb-4 relative">
            <img src="https://images.pexels.com/photos/7688453/pexels-photo-7688453.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2" alt="Employeurs" class="absolute inset-0 w-full h-full object-cover object-top" width="1260" height="750">
          </div>
          <h3 class="text-2xl font-light mb-4 text-black">{content.employeurs.title}</h3>
          <p class="mb-4 text-dark-gray font-light leading-relaxed">{content.employeurs.description}</p>
          <a href={`/${lang}/employeurs`} class="inline-block bg-light-green text-black px-4 py-2 rounded-sm hover:bg-black hover:text-light-green transition duration-300 text-sm uppercase font-light">{content.employeurs.cta}</a>
        </div>
      </div>
    </div>
  </section>
  
  <section id="profil" class="py-20">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-light mb-12 text-center text-black">{content.profil.title}</h2>
      <div class="max-w-4xl mx-auto">
        <div class="flex flex-col md:flex-row items-center md:items-start gap-4">
          <Picture src={profileImage} formats={['avif', 'webp']} alt="Christine Rizzo" class="w-full md:w-2/3 h-auto object-cover rounded-sm" decoding="async" loading="lazy" />
          <div class="md:w-1/2">
            <p class="text-dark-gray font-light leading-relaxed mb-6">{content.profil.description}</p>
            <a href={`/${lang}/profil`} class="bg-transparent text-black border border-black px-6 py-3 rounded-sm hover:bg-black hover:text-white transition duration-300 uppercase text-sm font-light">En savoir plus →</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Honoraires Section -->
  <section id="honoraires" class="py-12 md:py-20 bg-light-gray">
    <div class="container mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-light mb-8 md:mb-12 text-center text-black">{content.honoraires.title}</h2>
      <ul class="honoraires-list text-left md:text-center mb-8 md:mb-12 space-y-4 max-w-xl mx-auto">
        {content.honoraires.list.map((item: string, index: number) => (
          <li set:key={index} class="text-black font-light flex items-center md:justify-center">
            <CheckCircle class="text-dark-green mr-3 flex-shrink-0 w-5 h-5" />
            <span>{item}</span>
          </li>
        ))}
      </ul>
      <div class="text-center">
        <a href="#" class="inline-block bg-transparent text-black border border-black px-4 md:px-6 py-2 md:py-3 rounded-sm hover:bg-black hover:text-white transition duration-300 uppercase text-sm font-light">
          {content.honoraires.cta}
        </a>
      </div>
    </div>
  </section>
  
  <CTA lang={currentLang} />

  <!-- Articles Section -->
  <section id="articles" class="pb-20 pt-5 bg-beige">
    <div class="container mx-auto px-4">
      <h2 class="text-4xl font-light mb-12 text-center text-black">{content.articlesTitle}</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {recentArticles.map((article) => {
          const slug = article.slug.split('/').slice(1).join('/');
          return (
            <ArticleCard
              article={article}
              lang={lang}
              url={`/${lang}/blog/${slug}`}
            />
          );
        })}
      </div>
      <div class="text-center mt-12">
        <a href={`/${lang}/blog`} class="inline-block bg-transparent text-black border border-black px-6 py-3 rounded-sm hover:bg-black hover:text-white transition duration-300 uppercase text-sm font-light">
          {content.viewAllArticles}
        </a>
      </div>
    </div>
  </section>
</BaseLayout>