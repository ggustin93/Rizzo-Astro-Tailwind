---
import { getEntry } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { Briefcase, Shield, FileText, ChevronRight, Check } from 'astro-feather-icons';

export async function getStaticPaths() {
  return ['fr', 'en', 'it'].map(lang => ({ params: { lang } }));
}

const { lang } = Astro.params;
const travailleursEntry = await getEntry('travailleurs', 'travailleurs');
const content = travailleursEntry?.data[lang] || travailleursEntry?.data['fr']; // Use French as fallback

if (!content) {
  throw new Error(`Content not found for language: ${lang}`);
}

const iconMap = {
  Briefcase,
  Shield,
  FileText
};
---

<BaseLayout title={content.title} description={content.title} lang={lang}>
  <main class="container mx-auto px-4 py-16">
    <h1 class="text-4xl font-light mb-12 text-black text-center">{content.title}</h1>
    
    <div class="flex flex-col md:flex-row bg-light-travailleur">
      <!-- Left Column (2/3) -->
      <div class="md:w-2/3 bg-light-accent p-8 rounded-sm text-white">
        <p class="mb-6 text-dark-gray font-light">{content.description}</p>
        <ul class="space-y-2 mb-6">
          {content.questions.map((question: string, index: number) => (
            <li set:key={index} class="flex items-start">
              <ChevronRight class="w-5 h-5 mr-2 text-travailleur flex-shrink-0 mt-1" />
              <span class="text-gray-900 font-light">{question}</span>
            </li>
          ))}
        </ul>
        <p class="mb-4 text-dark-gray font-light">{content.specialFocus}</p>
        <ul class="space-y-2">
          {content.focusPoints.map((point: string, index: number) => (
            <li set:key={index} class="flex items-center">
              <Check class="w-5 h-5 mr-2 text-travailleur" />
              <span class="text-gray-900 font-light">{point}</span>
            </li>
          ))}
        </ul>
      </div>
      
      <!-- Right Column (1/3) -->
      <div class="md:w-1/3 bg-white p-8 rounded-sm">
        <h2 class="text-2xl font-light mb-6 text-black">{content.servicesTitle}</h2>
        <ul class="space-y-6">
          {content.services.map((service: any, index: number) => {
            const IconComponent = iconMap[service.icon as keyof typeof iconMap];
            return (
              <li set:key={index} class="flex items-start">
                <IconComponent class="w-8 h-8 mr-4 text-travailleur flex-shrink-0" />
                <span class="text-dark-gray font-light">{service.text}</span>
              </li>
            );
          })}
        </ul>
      </div>
    </div>
  </main>
</BaseLayout>